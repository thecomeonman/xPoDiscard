<!DOCTYPE html>
<?xml version="1.0" encoding="utf-8"?>

<html style = "margin:0;">

<head>
<title>xPo, A Way to Summarise Attacking Strategy</title>
<meta name="keywords" content="football, analysis, data science">
<meta name="description" content="This document describes xPo, a way to summarise attacking strategy">
<meta name="Author" content="Aditya Kothari">
</head>

<link rel = "stylesheet"
   type = "text/css"
   href = "./Assets/Stylesheet.css" />

<body style="background-color:#000000;margin:10px auto">

<button class='tablink3' onclick="openPage('Intro', this, '#880000', 'tablink3')">Introduction</button>
<button class='tablink3' onclick="openPage('setTeamAttackDashboard', this, '#880000', 'tablink3')" id="defaultOpen">Dashboard</button>
<button class='tablink3' onclick="openPage('ReachOut', this, '#880000', 'tablink3')">What Do You Think?</button>

<div id = 'Intro' class="tabContent">

    <h3>Demo details</h3>

    <p>
        Imagine you were coming up against the formidable Barcelona team from 
        2008-09 and wanted to identify patterns in their attacking play that 
        you could look out for and proactively defend against. This visualisation
        can help you with that. It also has the same analysis done for all the
        opponents in their games, to help you extract what Barclona may be more
        vulnerable to.
    </p>
    
    <h3>What is xPo?</h3>

    <p>
        xPo expands to expected potential.
    </p>

    <h3>How do you use xPo?</h3>

    <p>
        xPo assigns a value to various 
        attacking actions on the pitch. xPo is just an estimate of the 
        potential xG an action could eventually generate during that possession.
    </p>

    <h3>What is xG?</h3>

    <p>
        xG is just a probability assigned to a shot for it ending up in a goal. 
        There are multiple ways to calculate it and you'll find a whole host of 
        material about it online.
    </p>


    <h3>How is xPo calculated?</h3>

    <p>
        If you have the ball, then there are three things you can do with it:
    </p>

    <ul>
    <li>Pass it to some place</li>
    <li>Carry it to some place</li>
    <li>Shoot</li>
    </ul> 

    <p>
        Each of those actions may or may not eventually lead to a goal but we can 
        estimate how often they are 
        likely to lead to one. To do that, I evaluate three sets of numbers -
    </p>

    <ul>
        <li>
            xPo for shots: This is derived from the xG of the shots taken from
            those coordinates.
        </li>
        <li>
            xPo for passes: In the same spirit as xG, I evaluate the eventual xG 
            a play is likely to generate after a pass moving the ball from one 
            area of the pitch to another.
        </li>
        <li>
            xPo for carries: Calculated in the same way as xPo for passes
        </li>
    </ul>

    <p>
        The xPo for shots from an area is just an aggregated of the xG values
        of the shots taken from that area. I already have xG values in the 
        Statsbomb data and will use that as an input.
    </p>

    <p>
        Now we start looking at calculating xPo for passes and carries. 
        Let's say that in the first play that we look at there
        were 5 passes and 3 carries and that play eventually resulted in a shot 
        with an xG of 0.3. All 5 passes and all 3 carries would get an equal and
        complete credit of an xPo of 0.3. Let's say the next play were looking
        at didn't result in a shot then all the actions in that play get credited
        with an xPo of 0.
    </p>
    
    <p>
        It so happens that both the plays described above had a pass that originated
        in the same area as each other and ended in the same area as each other,
        i.e. we have two instances of a similar pass being played, one in each play. 
        In one case the eventual xG is 0.3, and in the other the eventual xG is 0. 
        The average eventual xG for such a pass therefore is 0.15 so we update
        the xPo for that pass as 0.15.
    </p>

    <p>
        We continue this process across all plays, considering all carries and all
        passes and keep aggregating the eventual xG generated by similar passes
        and carries. When we've finally gone through all the plays, we arrive at
        the final xPo value for every particular action a team has performed.
        Every pass between a set of coordinates, every carry between a set of 
        coordinates, and every shot from any coordinate now has an xPo value.
        Ta da!
    </p>

    <p>
        However, given the limited quantity of football that gets played, it's 
        not feasible to get enough samples of a pass or a carry or a shot at exactly
        the same set of coordinates. To get around this, I include events starting
        and ending in areas around the specific set of coordinates being looked 
        at as well. The farther these other events are from the exact pair of 
        coordinates we are calculating xPo for, the lesser weightage they get in
        the final xPo calculation for those coordinates.
    </p>


    <h3>Data used</h3>

    <p>
        I use data from <a href = "https://github.com/statsbomb/open-data" target="_blank"><img src = 'https://raw.githubusercontent.com/statsbomb/open-data/master/stats-bomb-logo.png' height = 30></a>
        where they have recorded 
        all of Barcelona's games from La Liga where Messi was involved.
        I'm going to focus on the games from 2008-09 and for simplicity's sake,
        I'm going to assume this to be a representative sample of all their games.
        I also use only data from when they were in a 4-3-3 formation which
        excludes a negligible amount of minutes from the data.
    </p>

    

</div>

<div id = 'setTeamAttackContent' class="tabContent">
<div id = 'TeamAttackContentSelection'></div>
<div id = 'TeamAttackContent'></div>
</div>


<div id = 'setTeamAttackDashboard' class="tabContent">
    <div id = 'TeamAttackDashboardParent' style="background-color:#000000;">
        <div id = 'TeamAttackDashboardSelection' style="background-color:#000000;height:50px;border-bottom:1px solid black;"></div>
        <div id = 'TeamAttackDashboard' style="background-color:#000000;"></div>
    </div>
</div>

<div id = 'ReachOut' class="tabContent">

    <p>
        Do you have any feedback, comments, questions, or interesting 
        observations? Or a dataset you'd like to run xPo for? You can 
        <a href = 'https://twitter.com/thecomeonman' target="_blank">find me on Twitter</a>!
    </p>


</div>


<!-- <script src = "./Assets/d3.v4.min.js"></script> -->
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src = "./Assets/Tabs.js"></script>
<script src = "./Assets/Visualisation3.js"></script>

<script>

    // constants for this particular file
    if ( true ) {

        allSetNames = [
            'Barcelona, La Liga, 2008-09',
            'GK: Victor Valdes',
            'LB: Eric Abidal, etc.',
            'LCB: Carles Puyol, Gerard Pique, etc.',
            'RCB: Rafael Marquez, Gerard Pique, etc.',
            'RB: Dani Alves, etc.',
            'CDM: Yaya Toure, Sergio Busquets',
            'LCM: Xavi, Seydou Keita, Gudjohnsen, etc.',
            'RCM: Xavi, Andres Iniesta, etc.',
            'LW: Thierry Henry, Andres Iniesta, etc.',
            'CF: Sameul Eto\'o, etc.',
            'RW: Lionel Messi, etc.',
            'Barcelona\'s Opponents, La Liga, 2008-09'
        ]

        allSetCodes = [
            'Barcelona200809LaLiga_For_Scoring_Team',
            'Barcelona200809LaLiga_For_Scoring_Player_GK',
            'Barcelona200809LaLiga_For_Scoring_Player_LB',
            'Barcelona200809LaLiga_For_Scoring_Player_LCB',
            'Barcelona200809LaLiga_For_Scoring_Player_RCB',
            'Barcelona200809LaLiga_For_Scoring_Player_RB',
            'Barcelona200809LaLiga_For_Scoring_Player_CDM',
            'Barcelona200809LaLiga_For_Scoring_Player_LCM',
            'Barcelona200809LaLiga_For_Scoring_Player_RCM',
            'Barcelona200809LaLiga_For_Scoring_Player_LW',
            'Barcelona200809LaLiga_For_Scoring_Player_CF',
            'Barcelona200809LaLiga_For_Scoring_Player_RW',
            'Barcelona200809LaLiga_Against_Scoring_Team'
        ]

        selectedSetCode = 'Barcelona200809LaLiga_For_Scoring_Team'

        nBlockWidth = 2

        bExplainerTest = true

        postCode = 'TeamAttackPost'
        
        cContentPanelId = 'TeamAttackContent'        
        setSelectionContentPanelId = 'TeamAttackContentSelection'
        
        cDashboardPanelId = 'TeamAttackDashboard'        
        cDashboardParentPanelId = 'TeamAttackDashboardParent'        
        setSelectionDashboardPanelId = 'TeamAttackDashboardSelection'

    }

    fBuildVisualisation (
        allSetNames,
        allSetCodes,
        selectedSetCode,
        nBlockWidth,
        bExplainerTest,
        postCode,
        cContentPanelId,
        cDashboardPanelId,
        cDashboardParentPanelId,
        setSelectionContentPanelId,
        setSelectionDashboardPanelId
    )
    
</script>



</body>
</html>
